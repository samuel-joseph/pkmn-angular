<div [ngSwitch]="battlePhase"
  class="parent"
>
  <div
  class="on-going"
   *ngSwitchCase="'on-going'">
    <div class="playerIdle">
      <img
      *ngIf="this.playerAttackMotion&&this.playerAttackClass=='physical'"
      alt=""
      class="playerPhysical"
        [src]="this.currentPlayer1[0].back_image" 
      />
    </div>
    <div *ngIf="this.currentPlayer2.length>0"
    style="
    display: flex;
    justify-content: flex-end;
    flex-direction: column;
    "
    >
    <div [ngStyle]="{
      'background-color':
      this.burnOrToxicNpc == 'burn'? 'red':
      this.burnOrToxicNpc == 'poison'? 'violet':
      'green',
      'border': 
      this.currentPlayer2[0].others.condition == 'poison'? '2px solid violet' : 
      this.currentPlayer2[0].others.condition == 'burn' ? '2px solid red' : 
      this.currentPlayer2[0].others.condition == 'paralysis' ? '2px solid yellow': 
      'none', 
      'height':'5vh',
      'position': 'relative',
      'width': this.npcHpPercentage
    }">
    <p
    style="position: fixed; font-size: x-large;"
    >
      {{this.currentPlayer2[0].currentHp}}/{{this.currentPlayer2[0].maxHp}}
    </p>
    <p
    *ngIf="this.playerAttackMotion&&this.npcDamageReceive>0"
    class="damageReceived"
    >-{{this.npcDamageReceive}}</p>
    <p
    *ngIf="this.playerAttackMotion&&this.npcDamageReceive==0"
    class="damageReceived"
    >MISS</p>
    </div>
      <div style="display: flex; justify-content: flex-end;">
        <img
        *ngIf="this.playerAttackMotion&&this.npcDamageReceive>0"
        class="attackFx"
        alt=""
        [src]="this.playerCurrentMoveFx"
        />
        <p style="position: absolute;" *ngIf="this.npcCondition!==''">{{this.npcCondition}}</p>
        <div
        *ngIf="this.currentPlayer2[0].currentHp>0"
        alt=""
        [ngClass]="
        this.npcAttackMotion&&this.npcAttackClass==='physical'?'pokemonFade':
        this.npcAttackMotion&&this.npcAttackClass==='special'?'npcPokemon':
        this.npcbuffOn?'powerupfx':''
        ">
          <img        
          alt=""
          [src]="this.currentPlayer2[0].front_image" 
          [ngClass]="this.npcMegaEvolve?'auraShuriken':'ordinaryPokemonImg'
          " />
        </div>
        <img
        *ngIf="this.currentPlayer2[0].currentHp<=0"
        class="faintedPokemon"
        [src]="this.currentPlayer2[0].front_image"
        alt=""
        />
      </div>
    </div>
    <div>
      <img
      *ngIf="this.npcAttackMotion&&this.npcAttackClass=='physical'"
      alt=""
      [ngClass]="this.npcMegaEvolve? 'megaNpcPhysical':'npcPhysical'"
        [src]="this.currentPlayer2[0].front_image" 
      />
    </div>
    <div *ngIf="this.currentPlayer1.length>0"
    style="
    display: flex;
    justify-content: flex-start;
    flex-direction: column;
    margin-top: 10vh;
    "
    >
      <div>
        <img
        *ngIf="this.npcAttackMotion&&this.playerDamageReceive>0"
        class="attackFx"
        alt=""
        [src]="this.npcCurrentMoveFx"
        />
        <div 
        style="
        display: flex;
        flex-direction: row;
        position: absolute;
        "
        *ngIf="this.playerbuffOn">
          <div
          [style]="{
            'width':this.playerbuff.length == 1? '75%':this.playerbuff.length == 2 ? '50%':'16.7%'
          }"
           *ngFor="let buff of this.playerbuff">
            <img 
            alt=""
            class="buffFx"
            style="width:100%"
            [src]="
            buff=='attack'? this.powerup.attack:
            buff=='special-attack'?this.powerup.specialattack:
            buff=='speed'?this.powerup.speed
            :this.powerup.defense"
            />
          </div>
        </div>
        <p style="position: absolute;" *ngIf="this.playerCondition!==''">{{this.playerCondition}}</p>
        <div class="playerIdle">
          <img
          *ngIf="this.currentPlayer1[0].currentHp>0"
          alt=""
          [ngClass]="
          this.playerAttackMotion&&this.playerAttackClass==='physical'?'pokemonFade':
          this.playerAttackMotion&&this.playerAttackClass==='special'?'playerPokemon':
          this.playerbuffOn?'powerupfx':'ordinaryPokemonImg'
          "
          [src]="this.currentPlayer1[0].back_image" 
          />
        </div>
        <img
        *ngIf="this.currentPlayer1[0].currentHp<=0"
        class="faintedPokemon"
        [src]="this.currentPlayer1[0].back_image"
        alt=""
        />
        <div>
        </div>
      </div>
      <div [ngStyle]="{
        'background-color':
        this.burnOrToxicPlayer == 'burn'? 'red':
        this.burnOrToxicPlayer == 'poison'? 'violet':
        'green',
        'height':'5vh',
        'position': 'relative',
        'width': this.playerHpPercentage
      }">
      <p
      style="position: fixed; text-align: center; font-size: x-large;"
      >
      {{this.currentPlayer1[0].currentHp}}/{{this.currentPlayer1[0].maxHp}}
      </p>
      <p
      *ngIf="this.npcAttackMotion&&this.playerDamageReceive>0"
      class="damageReceived"
      >-{{this.playerDamageReceive}}</p>
      <p
      *ngIf="this.npcAttackMotion&&this.playerDamageReceive==0"
      class="damageReceived"
      >MISS</p>
      </div>
    </div>
    <div [ngSwitch]="playerOption"
    class="playerOption"
    >
    <div *ngSwitchCase="'fight'">
      <div *ngIf="moveOverview.length==0">
        <div         
        *ngIf="!this.ongoingBattle">
          <div
          style="
          display: flex;
          justify-content: center;
          margin-bottom: 5px;
          "
          *ngFor="let move of this.currentPlayer1[0].moves">
            <button
            [ngStyle]="{
              'border-radius': '20px',
              'border': 'solid white',
              'margin-bottom': '5px',
              'text-shadow': '0 0 white',
              'width': '180px',
              'color': 'white',
              'padding': '5px',
              'background-color':
              move.type == 'fire' ? 'red' : 
              move.type == 'water' ? 'blue' :
              move.type == 'grass' ? 'green' :
              move.type == 'psychic' ? 'purple' :
              move.type == 'rock' ? 'brown' :
              move.type == 'ground' ? 'brown' :
              move.type == 'fighting' ? 'brown' :
              move.type == 'poison' ? 'violet' :
              move.type == 'dragon' ? 'darkviolet' :
              move.type == 'fairy' ? 'pink' :
              move.type == 'flying' ? 'gray' :
              move.type == 'normal' ? 'gray' :
              move.type == 'dark' ? 'black' : 
              move.type == 'bug' ? 'lightgreen' :
              move.type == 'ghost' ? 'violet' : 
              move.type  == 'electric' ? '#b1b100' : 'black'
            }
            " 
            (click)="this.openOverview(move)" 
            >{{move.name}}</button>
            </div>
            <div *ngIf="this.currentPlayer1" (click)="this.decisionOption('default')"
            style="text-align: center; color: white;"
            >back</div>
          </div>
        </div>
      </div>
      <div *ngIf="moveOverview.length!=0">
        <div style="
        display: flex;
        font-size: small;
        flex-direction: column;
        color:white;
        " 
        *ngFor="let move of moveOverview"
        >
          <h6 style="text-align: center; border-bottom: 2px solid;">{{move.name.toLocaleUpperCase()}}</h6>
          <div style="display: flex; flex-direction: row; justify-content: space-around;">
            <span>Power: {{move.power}}</span>
            <span>Type: {{move.type}}</span>
          </div>
          <div style="display: flex; flex-direction: row; justify-content: space-around; border-bottom: 2px solid black;">
            <span>PP: {{move.pp}}/{{move.ppMax}}</span>
            <span>{{move.damageClass.name}}</span>
          </div>
          <span>Description: {{move.description}}</span>
          <span style="border-bottom: 2px solid white;">Accuracy: {{move.accuracy}}</span>
          <div>
            <h6 style="text-align: center; color:white;">Use this move?</h6>
            <div style="display: flex; flex-direction: row; justify-content: space-around;">
              <button *ngIf="move.pp!=0" style="border-radius: 20px; color:black;" (click)="this.chosenMove(move)">YES</button>  
              <button style="border-radius: 20px; color:black;" (click)="this.closeOverview()">NO</button>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="this.ongoingBattle">
        <p style="text-align: center; font-size: 14pt; color:white; padding-top: 5vh;">{{this.narrate}}</p>
      </div>
      <div *ngSwitchCase="'default'">
        <div
        *ngIf="!this.ongoingBattle"
        style="
        display: flex;
        flex-direction: column;
        justify-content: center;
        margin-bottom: 5px;
        align-items: center;
        ">
        <button (click)="this.decisionOption('fight')" style="width: 40vw; border: none; background: none; padding: 8px 0px; border-bottom: 2px solid white; color:white;">Fight</button>
        <button *ngIf="this.player1.length!==0" (click)="this.decisionOption('swap')" style="width: 40vw; border: none; background: none; padding: 8px 0px; border-bottom: 2px solid white; color: white;">Swap</button>
        </div>
      </div>
      <div *ngSwitchCase="'swap'">
        <div 
        style="
        display: flex;
        justify-content: center;
        margin-bottom: 5px;
        align-items: center;
        "
        *ngFor="let pokemon of this.player1">
          <button style="width: 40vw; border: none; background: none; padding: 8px 0px; border-bottom: 2px solid white; color:white;" (click)="this.swapOption(pokemon)">{{pokemon.name}}</button>
        </div>
        <div *ngIf="this.currentPlayer1" (click)="this.decisionOption('default')"
        style="text-align: center; color:white;"
        >back</div>
      </div>
    </div>
  </div>

  <div
  class="battleDone"
   *ngSwitchCase="'battle-done'">
    <div class="parent">
      <div 
      *ngFor="let pokemon of this.tempPokemonContainer2"
      >
        <img 
        alt=""
        *ngIf="pokemon.currentHp<=0"
        class="loseOutcome"
        src="https://static.vecteezy.com/system/resources/previews/017/178/056/original/red-cross-mark-on-transparent-background-free-png.png"
         />
         <img
         alt=""
         class="pokemonImage"
         [src]="pokemon.front_image" />
      </div>
    </div>
    <div class="parent">
      <div *ngFor="let pokemon of this.tempPokemonContainer1">
        <img 
          alt=""
          *ngIf="pokemon.currentHp<=0"
          class="loseOutcome"
          src="https://static.vecteezy.com/system/resources/previews/017/178/056/original/red-cross-mark-on-transparent-background-free-png.png"
           />
           <img
           alt=""
           class="pokemonImage"
            [src]="pokemon.front_image" />
      </div>
    </div>
    <div 
    *ngIf="this.outcome=='win';else lose"
    class="outcomeBanner"
    >
      <div>
        <h2>Congratulations you have defeated {{this.leaderInfo.name}}!</h2>
        <div style="display: flex; flex-direction: column; align-items: center;">
          <img
          alt=""
          src={{this.leaderInfo.gymBadge}}
          />
          <h2>You received a badge!!!</h2>
        </div>
      </div>
    </div>
    <ng-template
    class="outcomeBanner"
     #lose>
      <h2>You lost!!!</h2>
    </ng-template>
  </div>
</div>